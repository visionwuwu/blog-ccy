---
title: è§‚å¯Ÿè€…æ¨¡å¼
date: 2020-05-20 21:00:30
tags:
- javascript
catetories: 
- å‰ç«¯
---

<Boxx />

[[toc]]

è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒè®¢é˜…æ¨¡å¼ä¹‹é—´æœ‰è”ç³»ï¼Ÿ
---
> ç­”æ¡ˆæ˜¯ è§‚å¯Ÿè€…æ¨¡å¼ åŒ…å« å‘å¸ƒè®¢é˜…æ¨¡å¼

è§‚å¯Ÿè€…æ¨¡å¼ä¸å‘å¸ƒè®¢é˜…è€…æ¨¡å¼åŒºåˆ«
---
> è§‚å¯Ÿè€…æ¨¡å¼ä¸­è§‚å¯Ÿè€…ä¸è¢«è§‚å¯Ÿè€…ä¹‹é—´æœ‰å…³è”
è€Œå‘å¸ƒè®¢é˜…è€…æ¨¡å¼ä¸­å‘å¸ƒè€…ä¸è®¢é˜…è€…æ²¡æœ‰ä»»ä½•çš„å…³ç³»å…¨é ä¸­é—´ä»£ç†æ¥å¤„ç†

> è¢«è§‚å¯Ÿè€…ä¸­æœ‰æ‰€æœ‰çš„è§‚å¯Ÿè€…å½“è¢«è§‚å¯Ÿè€…çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…è€Œå‘å¸ƒè®¢é˜…è€…æ¨¡å¼ä¸­å‘å¸ƒè€…emitå‘å°„æ•°æ®å¹¶é€šè¿‡ä¸­é—´ä»£ç†é€šçŸ¥æ‰€æœ‰çš„è®¢é˜…è€…è§¦å‘å›è°ƒ

---
::: tip ğŸ‘‡ğŸ‘‡ğŸ‘‡
è¯ä¸å¤šè¯´ä¸Šä»£ç  :roll_eyes:
:::
---

è§‚å¯Ÿè€…ä»£ç ä¾‹å­
---
- ä¸¾ä¸ªçˆ¸çˆ¸å¦ˆå¦ˆè§‚å¯Ÿå°å®å®çš„å¿ƒæƒ…çŠ¶æ€çš„ä¾‹å­
- çˆ¸çˆ¸ï¼Œå¦ˆå¦ˆæ˜¯è§‚å¯Ÿè€…
- å°å®å®è¢«è§‚å¯Ÿè€…

> è¢«è§‚å¯Ÿè€… å°å®å® å¿ƒæƒ…å¥½ :smile: => å¿ƒæƒ…ä¸å¥½ :pout:

> è¢«è§‚å¯Ÿè€… å°å®å® å¿ƒæƒ…å¥½ :smile: => å¿ƒæƒ…ä¸å¥½ :rofl:

``` js
//è¢«è§‚å¯Ÿè€…
class Subject {
    constructor(){
        // æ¥æ”¶æ‰€æœ‰çš„è§‚å¯Ÿè€… (çˆ¸çˆ¸ï¼Œå¦ˆå¦ˆ)
        this.callbacks = []
        // è¢«è§‚å¯Ÿè€…çš„çŠ¶æ€ (å°å®å®çš„å¿ƒæƒ…çŠ¶æ€)
        this.state = 'very happyğŸ˜„'
    }

    // æä¾›ä¸€ä¸ªæ¥å—æ‰€æœ‰è§‚å¯Ÿè€…çš„æ–¹æ³•
    attach(observer){
        this.callbacks.push(observer)
    }

    // è¢«è§‚å¯Ÿè€…æä¾›ä¸€ä¸ªæ”¹å˜çŠ¶æ€çš„æ–¹æ³•
    setState(newState){
        this.state = newState;
        // å½“è¢«è§‚å¯Ÿè€…çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…è¿›è¡Œç›¸åº”çš„æ›´æ–°æ“ä½œ
        this.callbacks.forEach(observer => observer.update(newState))
    }


}

// è§‚å¯Ÿè€…
class Observer {
    constructor(name){
        this.name = name
    }

    // é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…æ›´æ–°
    update(newState){
        console.log(this.name + 'å‘ç°å°å®å®ï¼š' + newState)
    }
}

let subject = new Subject()
let observer1 = new Observer('çˆ¸çˆ¸')
let observer2 = new Observer('å¦ˆå¦ˆ')
subject.attach(observer1)
subject.attach(observer2)

/**
 * çˆ¸çˆ¸å‘ç°å°å®å®ï¼šç”Ÿæ°”äº†ğŸ˜¡
 * å¦ˆå¦ˆå‘ç°å°å®å®ï¼šç”Ÿæ°”äº†ğŸ˜¡
*/
subject.setState('ç”Ÿæ°”äº†ğŸ˜¡')
/**
 * çˆ¸çˆ¸å‘ç°å°å®å®ï¼šrofl -- ğŸ¤£
 * å¦ˆå¦ˆå‘ç°å°å®å®ï¼šrofl -- ğŸ¤£
*/
subject.setState('rofl -- ğŸ¤£')
```